{{ $services := .Site.Data.services.services }}

<div class="services-status">
  <h3 class="services-header" onclick="toggleServicesStatus()">
    Current Service Status 
    <span class="toggle-arrow" id="servicesArrow">▼</span>
  </h3>
  
  {{ if $services }}
    <div class="services-grid" id="servicesGrid">
      {{ range $services }}
        <div class="service-item">
          <div class="service-name">{{ .name }}</div>
          <div class="service-status status-{{ .status }}">
            {{ if eq .status "operational" }}
              ✅ Operational
            {{ else if eq .status "disrupted" }}
              ⚠️ Disrupted
            {{ else if eq .status "down" }}
              ❌ Down
            {{ else }}
              ❓ Unknown
            {{ end }}
          </div>
        </div>
      {{ end }}
    </div>
  {{ else }}
    <p>No service status data available.</p>
  {{ end }}
</div>

<style>
.services-status {
  margin: 2rem 0;
  padding: 1rem;
  background: white;
  border-radius: 8px;
}

.services-status h3 {
  margin-bottom: 1rem;
  color: #333;
}

.services-header {
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  align-items: center;
  user-select: none;
  transition: color 0.2s;
}

.services-header:hover {
  color: #00D15A;
}

.toggle-arrow {
  font-size: 0.8em;
  transition: transform 0.3s ease;
}

.toggle-arrow.collapsed {
  transform: rotate(-90deg);
}

.services-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 1rem;
  transition: all 0.3s ease;
  overflow: hidden;
}

.services-grid.collapsed {
  max-height: 0;
  opacity: 0;
  margin: 0;
  padding: 0;
}

.service-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.75rem;
  background: white;
  border-radius: 4px;
  border: 1px solid #dee2e6;
}

.service-name {
  font-weight: 500;
  color: #333;
}

.service-status {
  padding: 0.25rem 0.75rem;
  border-radius: 20px;
  font-size: 0.875rem;
  font-weight: 500;
}

.status-operational {
  background: #d4edda;
  color: #155724;
}

.status-disrupted {
  background: #fff3cd;
  color: #856404;
}

.status-down {
  background: #f8d7da;
  color: #721c24;
}
</style>

<script>
function toggleServicesStatus() {
  const grid = document.getElementById('servicesGrid');
  const arrow = document.getElementById('servicesArrow');
  
  if (grid && arrow) {
    grid.classList.toggle('collapsed');
    arrow.classList.toggle('collapsed');
    
    // Save state to localStorage
    const isCollapsed = grid.classList.contains('collapsed');
    localStorage.setItem('servicesStatusCollapsed', isCollapsed);
  }
}

// Restore state on page load
document.addEventListener('DOMContentLoaded', function() {
  const isCollapsed = localStorage.getItem('servicesStatusCollapsed') === 'true';
  const grid = document.getElementById('servicesGrid');
  const arrow = document.getElementById('servicesArrow');
  
  if (isCollapsed && grid && arrow) {
    grid.classList.add('collapsed');
    arrow.classList.add('collapsed');
  }
});
</script>
